# フィールド作成ツール操作手順書

## 1. 概要

フィールド作成ツールは、データベースのフィールド定義から Java クラスのフィールド宣言を自動生成するためのツールである。

### 主な機能

- データベースフィールド定義から Java フィールド宣言の自動生成
- データベース型から Java 型への自動変換
- フィールド名のキャメルケース変換
- テンプレートベースの柔軟な出力形式
- 中間ファイルを経由した安全な処理

## 2. ファイル配置

### 2.1 ディレクトリ構造

```text
kmg-tool/
├── work/io/                          # 優先パス（開発時推奨）
│   ├── input.txt                     # 入力ファイル
│   ├── output.txt                    # 出力ファイル
│   └── template/
│       └── FieldCreationTool.yml     # テンプレートファイル
└── src/main/resources/tool/io/       # 代替パス
    ├── input.txt                     # 入力ファイル
    ├── output.txt                    # 出力ファイル
    └── template/
        └── FieldCreationTool.yml     # テンプレートファイル
```

### 2.2 ファイルパスの優先順位

1. **優先パス**: `work/io/` ディレクトリが存在する場合
2. **代替パス**: `work/io/` ディレクトリが存在しない場合、`src/main/resources/tool/io/` を使用

## 3. 入力ファイルの準備

### 3.1 入力ファイル形式

入力ファイル（`input.txt`）は、1 行につき 1 つのフィールド定義を半角スペース区切りで記述する：

```text
コメント フィールド名 データ型
```

### 3.2 入力ファイル例

```text
ユーザーID user_id 文字列型
ユーザー名 user_name 文字列型
年齢 age 整数型
作成日時 created_at 日時型
更新フラグ update_flag 論理型
```

### 3.3 入力ファイルの詳細仕様

#### 3.3.1 コメント（第 1 カラム）

- フィールドの説明を記述する
- 日本語での記述を推奨
- 空白を含む場合も 1 つのコメントとして扱われる

#### 3.3.2 フィールド名（第 2 カラム）

- データベースのフィールド名を記述する
- アンダースコア記法（snake_case）で記述する
- 自動的にキャメルケース（camelCase）に変換される
- 例：`user_name` → `userName`、`created_at` → `createdAt`

#### 3.3.3 データ型（第 3 カラム）

- データベースの型または Java の型を記述する
- サポートされているデータベース型：
  - `文字列型` → `String`
  - `整数型` → `Integer`
  - `長整数型` → `Long`
  - `日時型` → `LocalDateTime`
  - `日付型` → `LocalDate`
  - `論理型` → `Boolean`
  - `小数型` → `BigDecimal`
- 未知の型の場合は、そのまま出力される

### 3.4 入力ファイルの注意事項

- 各行は必ず「コメント フィールド名 データ型」の 3 要素で構成する
- 要素間は半角スペースで区切る
- 要素数が 3 未満の行は無視される
- 空行は処理対象外
- ファイルエンコーディングは UTF-8 を推奨

## 4. テンプレートファイルの設定

### 4.1 テンプレートファイルの場所

- **優先パス**: `work/io/template/FieldCreationTool.yml`
- **代替パス**: `src/main/resources/tool/io/template/FieldCreationTool.yml`

### 4.2 テンプレートファイルの設定方法

テンプレートファイルの詳細な構造や設定方法については、実際のテンプレートファイル（`FieldCreationTool.yml`）を参照してください。テンプレートファイルには、プレースホルダーの定義やテンプレート内容の設定方法が記載されています。

## 5. 実行手順

### 5.1 基本的な実行方法

1. **入力ファイルの準備**

   ```bash
   # work/ioディレクトリを作成（存在しない場合）
   mkdir -p work/io

   # 入力ファイルを作成
   cat > work/io/input.txt << 'EOF'
   ユーザーID user_id 文字列型
   ユーザー名 user_name 文字列型
   年齢 age 整数型
   作成日時 created_at 日時型
   更新フラグ update_flag 論理型
   EOF
   ```

2. **テンプレートファイルの配置**

   ```bash
   # テンプレートディレクトリを作成
   mkdir -p work/io/template

   # テンプレートファイルをコピー
   cp src/main/resources/tool/io/template/FieldCreationTool.yml work/io/template/
   ```

3. **ツールの実行**

   ```bash
   # Mavenを使用して実行
   mvn exec:java -Dexec.mainClass="kmg.tool.fldcrt.presentation.ui.cli.FieldCreationTool"

   # または、JARファイルから実行
   java -cp target/classes:target/dependency/* kmg.tool.fldcrt.presentation.ui.cli.FieldCreationTool
   ```

### 5.2 コマンドライン引数

現在のバージョンでは、コマンドライン引数は使用されない。ファイルパスは自動的に決定される。

### 5.3 実行時のログ出力

実行時には以下のようなログが出力される：

```text
[INFO] フィールド作成ツール開始
[INFO] 入力ファイル: work/io/input.txt
[INFO] テンプレートファイル: work/io/template/FieldCreationTool.yml
[INFO] 出力ファイル: work/io/output.txt
[DEBUG] 処理中: ユーザーID
[DEBUG] 処理中: ユーザー名
[DEBUG] 処理中: 年齢
[DEBUG] 処理中: 作成日時
[DEBUG] 処理中: 更新フラグ
[INFO] 処理完了: 5件のフィールドを処理しました
[INFO] フィールド作成ツール終了
```

## 6. 出力ファイルの確認

### 6.1 出力ファイルの場所

- **優先パス**: `work/io/output.txt`
- **代替パス**: `src/main/resources/tool/io/output.txt`

### 6.2 出力例

入力ファイルの例に対して、以下のような出力が生成される：

```java
/** ユーザーID */
private String userId;

/** ユーザー名 */
private String userName;

/** 年齢 */
private Integer age;

/** 作成日時 */
private LocalDateTime createdAt;

/** 更新フラグ */
private Boolean updateFlag;
```

### 6.3 型変換の例

| データベース型 | Java 型         | 備考          |
| -------------- | --------------- | ------------- |
| `文字列型`     | `String`        | 文字列データ  |
| `整数型`       | `Integer`       | 32 ビット整数 |
| `長整数型`     | `Long`          | 64 ビット整数 |
| `日時型`       | `LocalDateTime` | 日付と時刻    |
| `日付型`       | `LocalDate`     | 日付のみ      |
| `論理型`       | `Boolean`       | true/false    |
| `小数型`       | `BigDecimal`    | 任意精度小数  |
| `カスタム型`   | そのまま出力    | 未知の型      |
